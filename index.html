<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Sep 22, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20120922" />
    <meta http-equiv="Content-Language" content="en" />
    <title>JGroups AWS Discovery - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/meltmedia/jgroups-aws">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>JGroups AWS Discovery</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2012-09-22</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.2.0-SNAPSHOT</li>
                      
                
            
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                                
      <li class="active">
    
            <a href="#"><i class="none"></i>Usage</a>
          </li>
                  
      <li>
    
                          <a href="apidocs/index.html" title="JavaDocs">
          <i class="none"></i>
        JavaDocs</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                  
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-down"></i>
        Project Information</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="integration.html" title="Continuous Integration">
          <i class="none"></i>
        Continuous Integration</a>
            </li>
                      
      <li>
    
                          <a href="project-summary.html" title="Project Summary">
          <i class="none"></i>
        Project Summary</a>
            </li>
                      
      <li>
    
                          <a href="mail-lists.html" title="Mailing Lists">
          <i class="none"></i>
        Mailing Lists</a>
            </li>
                      
      <li>
    
                          <a href="issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                      
      <li>
    
                          <a href="plugins.html" title="Project Plugins">
          <i class="none"></i>
        Project Plugins</a>
            </li>
                      
      <li>
    
                          <a href="license.html" title="Project License">
          <i class="none"></i>
        Project License</a>
            </li>
                      
      <li>
    
                          <a href="distribution-management.html" title="Distribution Management">
          <i class="none"></i>
        Distribution Management</a>
            </li>
                      
      <li>
    
                          <a href="source-repository.html" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                      
      <li>
    
                          <a href="team-list.html" title="Project Team">
          <i class="none"></i>
        Project Team</a>
            </li>
                      
      <li>
    
                          <a href="plugin-management.html" title="Plugin Management">
          <i class="none"></i>
        Plugin Management</a>
            </li>
                      
      <li class="active">
    
            <a href="#"><i class="none"></i>About</a>
          </li>
                      
      <li>
    
                          <a href="dependencies.html" title="Dependencies">
          <i class="none"></i>
        Dependencies</a>
            </li>
              </ul>
        </li>
                                                                                                                                                              
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
            
                
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://meltmedia.github.com/jgroups-aws" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>AWS Auto Discovery for JGroups</h1><div class="section"><h2>Overview<a name="Overview"></a></h2><p>This package provides auto discovery for other custer members on AWS using both tag matching and filters. It is a drop in replacement for TCPPING, allowing you to remove the definition of your initial members from your configuraiton file.</p></div><div class="section"><h2>Usage<a name="Usage"></a></h2><p>To use AWS auto discovery, you need to add a dependency to this package in your pom:</p>
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
  &lt;groupId&gt;com.meltmedia.jgroups&lt;/groupId&gt;
  &lt;artifactId&gt;jgroups-aws&lt;/artifactId&gt;
  &lt;version&gt;1.1.0&lt;/version&gt;
&lt;/dependency&gt;
</pre></div><p>and then replace TCPPING in your stack with com.meltmedia.jgroups.aws.AWS_PING:</p>
<div class="source"><pre class="prettyprint">&lt;com.meltmedia.jgroups.aws.AWS_PING
     timeout=&quot;3000&quot;
     port_number=&quot;7800&quot;
     tags=&quot;TAG1,TAG2&quot;
     filters=&quot;NAME1=VALUE1,VALUE2;NAME2=VALUE3&quot;
     access_key=&quot;AWS_ACCESS_KEY&quot;
     secret_key=&quot;AWS_SECRET_KEY&quot;/&gt;
</pre></div><p>see the configuration section for information. You can find an example stack in conf/aws_ping.xml.</p><p>This implementation will only work from inside EC2, since it uses environment information to auto wire itself. See the Setting Up EC2 section for more information.</p></div><div class="section"><h2>Configuration Options<a name="Configuration_Options"></a></h2>
<ul>
  <li>timeout - the timeout in milliseconds</li>
  <li>port_number - the port number that the nodes will communicate over. This needs to be the same on all nodes. The default is 7800.</li>
  <li>tags - A comma delimited list of EC2 node tag names. The current nodes values are matched against other nodes to find cluster members.</li>
  <li>filters - A colon delimited list of filters. Each filter defines a name and a comma delimited list of possible values. All filters must match a node for it to be a cluster member.</li>
  <li>access_key and secret_key - the access key and secret key for an AWS user with permission to the ec2:Describe* action. If both of these attributes are not specified, then the instance profile for the EC2 instance will be used (Since version 1.1).</li>
</ul></div><div class="section"><h2>Setting Up EC2<a name="Setting_Up_EC2"></a></h2><p>You will need to setup the following in EC2, before using this package:</p>
<ul>
  <li>The EC2 instances will need permission to the ec2:Describe* action. You can either create an IAM user with this permission and pass the users credentials with the access_key and secret_key attributes or associate an instance profile with that permission to the instances and not specify the access_key and secret_key attributes.</li>
  <li>In the EC2 console, you will need to create a security group for your instances. This security group will need a TCP_ALL rule, with itself as the source (put the security groups name in the source field.) This will allow all of the nodes in that security group to communicate with each other.</li>
  <li>Create two EC2 nodes, making sure to include the security group granting TCP communication.</li>
  <li>If you are going to use the tag matching feature, then define a few tags on the nodes with matching values.</li>
</ul></div><div class="section"><h2>Setting up JGroups Chat Demo<a name="Setting_up_JGroups_Chat_Demo"></a></h2><p>The JGroups project provides a chat application that is great for testing your configuration. To set up the chat application, first create two EC2 nodes, following the Setting Up EC2 instructions. Once the nodes are created, SSH into each machine and install the java 6 JDK, Maven 3, and Git.</p>
<div class="source"><pre class="prettyprint">sudo apt-get install openjdk-6-jdk
wget http://www.carfab.com/apachesoftware/maven/binaries/apache-maven-3.0.4-bin.tar.gz
sudo tar xzf apache-maven-3.0.4-bin.tar.gz /opt
ln -s /opt/maven /opt/apache-maven-3.0.4
echo &quot;export PATH=/opt/maven/bin:$PATH&quot; &gt;&gt; .profile
. ~/.profile
sudo apt-get install git
mkdir ~/git
</pre></div><p>Now your machine is ready to compile maven projects.</p><p>Next, clone and build this project.</p>
<div class="source"><pre class="prettyprint">cd ~/git
git clone git://github.com/meltmedia/jgroups-aws.git
cd jgroups-aws
mvn clean install
</pre></div><p>Finally, it is time to run the project. You will need to edit the configuration in conf/aws-ping.xml. Add values for the tags, access_key and secret_key attributes. Remove the filters attribute. Then execute the following:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;org.jgroups.demos.Chat&quot; -Dexec.args=&quot;-props conf/aws-ping.xml&quot;
</pre></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2012
                        <a href="http://www.meltmedia.com/">meltmedia</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
